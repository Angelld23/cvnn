

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CVNN &mdash; cvnn 0.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Optimizers" href="optimizers.html" />
    <link rel="prev" title="Getting Started" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> cvnn
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CVNN</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#train">Train</a></li>
<li class="toctree-l2"><a class="reference internal" href="#results">Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="#others">Others</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="optimizers.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="layers.html">Complex Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="act_fun.html">Activation Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="initializers.html">Initializers</a></li>
<li class="toctree-l1"><a class="reference internal" href="montecarlo.html">Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="code_examples.html">Code Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="results.html">Results</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cvnn</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>CVNN</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/cvnn.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cvnn">
<h1>CVNN<a class="headerlink" href="#cvnn" title="Permalink to this headline">¶</a></h1>
<p>Short example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assume you already have complex data &#39;x&#39; with its labels &#39;y&#39;...</span>

<span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">layers</span><span class="o">.</span><span class="n">ComplexDense</span><span class="p">(</span><span class="n">output_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">input_size</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;cart_relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">ComplexDense</span><span class="p">(</span><span class="n">output_size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;cart_relu&#39;</span><span class="p">),</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">ComplexDense</span><span class="p">(</span><span class="n">output_size</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax_real&#39;</span><span class="p">)]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">CvnnModel</span><span class="p">(</span><span class="s2">&quot;cvnn_example&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">losses</span><span class="o">.</span><span class="n">categorical_crossentropy</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
</pre></div>
</div>
<dl class="class">
<dt id="CvnnModel">
<em class="property">class </em><code class="sig-name descname">CvnnModel</code><a class="headerlink" href="#CvnnModel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">name</em>, <em class="sig-param">shape</em>, <em class="sig-param">loss_fun</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">tensorboard=True</em><span class="sig-paren">)</span><a class="headerlink" href="#__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – Name of the model. It will be used to distinguish models</p></li>
<li><p><strong>shape</strong> – List of <code class="code docutils literal notranslate"><span class="pre">cvnn.layers.ComplexLayer</span></code> objects</p></li>
<li><p><strong>loss_fun</strong> – <code class="code docutils literal notranslate"><span class="pre">tensorflow.python.keras.losses</span></code> to be used.</p></li>
<li><p><strong>verbose</strong> – if <code class="code docutils literal notranslate"><span class="pre">True</span></code> it will print information of the model just created</p></li>
<li><p><strong>tensorboard</strong> – <p>If <code class="code docutils literal notranslate"><span class="pre">True</span></code> it will save tensorboard information inside <code class="code docutils literal notranslate"><span class="pre">log/.../tensorboard_logs/</span></code></p>
<ul>
<li><p>Loss and accuracy</p></li>
<li><p>Graph</p></li>
<li><p>Weights histogram</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="section" id="train">
<h2>Train<a class="headerlink" href="#train" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y=None</em>, <em class="sig-param">validation_split=0.0</em>, <em class="sig-param">validation_data=None</em>, <em class="sig-param">epochs: int = 10</em>, <em class="sig-param">batch_size: int = 32</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">display_freq: int = 1</em>, <em class="sig-param">save_model_checkpoints=False</em>, <em class="sig-param">save_csv_history=True</em>, <em class="sig-param">shuffle=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the model for a fixed number of epochs (iterations on a dataset).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input data. It could be:
- A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs).
- A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs).
- A tf.data dataset. Should return a tuple (inputs, targets). Preferred data type (less overhead).</p></li>
<li><p><strong>y</strong> – Labels/Target data. Like the input data x, it could be either Numpy array(s) or TensorFlow tensor(s).
If f x is a dataset then y will be ignored (default None)</p></li>
<li><p><strong>validation_split</strong> – Float between 0 and 1.
Percentage of the input data to be used as test set (the rest will be use as train set)
Default: 0.0 (No validation set).
This input is ignored if validation_data is given.</p></li>
<li><p><strong>validation_data</strong> – <p>Data on which to evaluate the loss and any model metrics at the end of each epoch.
The model will not be trained on this data. This parameter takes precedence over validation_split.
It can be:</p>
<blockquote>
<div><ul>
<li><p>tuple (x_val, y_val) of Numpy arrays or tensors. Preferred data type (less overhead).</p></li>
<li><p>A tf.data dataset.</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>epochs</strong> – (uint) Number of epochs to do.</p></li>
<li><p><strong>batch_size</strong> – (uint) Batch size of the data. Default 32 (because keras use 32 so… why not?)</p></li>
<li><p><strong>verbose</strong> – <p>Verbosity Mode
It can be:</p>
<blockquote>
<div><ul>
<li><p>Bool: False defaults to 0 and True to 1.</p></li>
<li><p>Int</p></li>
<li><p>String: Matching the modes string</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Verbosity Modes:</dt><dd><ul>
<li><p>”SILENT” or 0:  No prints of any kind</p></li>
<li><dl class="simple">
<dt>”FAST” or 2:    Does not show the progress bar of each epoch.</dt><dd><p>Verbosity modes “FAST” and “SILENT” saves the csv file (if save_csv_history) less often.
Making it faster riskier of data loss</p>
</dd>
</dl>
</li>
<li><p>”PROBAR” or 4:  Shows progress bar but does not show accuracy or loss (helps on speed)</p></li>
<li><p>”INFO” or 1:    Shows a progress bar with current accuracy and loss</p></li>
<li><p>”DEBUG” or 3:   Shows start and end messages and also the progress bar with current accuracy and loss</p></li>
</ul>
</dd>
</dl>
<p>Verbosity modes 0, 1 and 2 are coincident with <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit">tensorflow’s fit verbose parameter</a></p>
</p></li>
<li><p><strong>display_freq</strong> – Integer (Default 1)
Frequency on terms of epochs before saving information and running a checkpoint.</p></li>
<li><p><strong>save_model_checkpoints</strong> – (Boolean)
Save the model to be able to load and continue training later TODO: Not yet working</p></li>
<li><p><strong>save_csv_history</strong> – (Boolean) Save information of the train and test loss and accuracy on csv files.</p></li>
<li><p><strong>shuffle</strong> – (Boolean) Whether to shuffle the training data before each epoch. Default: True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="code docutils literal notranslate"><span class="pre">save_model_checkpoints</span></code> Not yet working. So default is False and will through error otherwise.</p>
</div>
</dd></dl>

</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#call" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward result of the network</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – Data input to be calculated</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output of the netowrk</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts the value of the class.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>ATTENTION: Use this only for classification tasks. For regression use <code class="code docutils literal notranslate"><span class="pre">call</span></code> method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – Input</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Prediction of the class that x belongs to.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="evaluate_loss">
<code class="sig-name descname">evaluate_loss</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#evaluate_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the output of x and computes the loss using y</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input of the netwotk</p></li>
<li><p><strong>y</strong> – Labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="evaluate_accuracy">
<code class="sig-name descname">evaluate_accuracy</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#evaluate_accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the output of x and returns the accuracy using y as labels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input of the netwotk</p></li>
<li><p><strong>y</strong> – Labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>accuracy</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="headerlink" href="#evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Compues both the loss and accuracy using <code class="code docutils literal notranslate"><span class="pre">evaluate_loss</span></code> and <code class="code docutils literal notranslate"><span class="pre">evaluate_accuracy</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Input of the netwotk</p></li>
<li><p><strong>y</strong> – Labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple (loss, accuracy)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="get_confusion_matrix">
<code class="sig-name descname">get_confusion_matrix</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">save_result=False</em><span class="sig-paren">)</span><a class="headerlink" href="#get_confusion_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a pandas data-frame with the confusion matrix of result of x and y (labels)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – data to which apply the model</p></li>
<li><p><strong>y</strong> – labels</p></li>
<li><p><strong>save_result</strong> – if <code class="code docutils literal notranslate"><span class="pre">True</span></code> it will save the confusion matrix as a csv at models path</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Confusion matrix pandas data-frame</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="others">
<h2>Others<a class="headerlink" href="#others" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="summary">
<code class="sig-name descname">summary</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a string of a summary representation of your model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>string of the summary of the model</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="is_complex">
<code class="sig-name descname">is_complex</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#is_complex" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><code class="code docutils literal notranslate"><span class="pre">True</span></code> if the network is complex. <code class="code docutils literal notranslate"><span class="pre">False</span></code> otherwise:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># x dtype is np.complex64</span>
</pre></div>
</div>
<dl class="simple">
<dt>if not model.is_complex():</dt><dd><p>x = cvnn.utils.transform_to_real(x)</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="get_real_equivalent">
<code class="sig-name descname">get_real_equivalent</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">classifier=True</em>, <em class="sig-param">name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#get_real_equivalent" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a new model equivalent of current model. If model is already real throws and error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier</strong> – <code class="code docutils literal notranslate"><span class="pre">True</span></code> (default) if the model is a classification model. <code class="code docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></li>
<li><p><strong>name</strong> – name of the new network to be created.
If <code class="code docutils literal notranslate"><span class="pre">None</span></code> (Default) it will use same name as current model with “_real_equiv” suffix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="code docutils literal notranslate"><span class="pre">CvnnModel()</span></code> real equivalent model</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="optimizers.html" class="btn btn-neutral float-right" title="Optimizers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="getting_started.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, J Agustin BARRACHINA

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>